!function(t){var e,i=null,a=!0,s={w:"请输入正确信息！",r:"通过信息验证！",c:"正在检测信息…",s:"请填入信息！",v:"所填信息没有经过验证，请稍后…",p:"正在提交数据…",err:"提交数据出错，请检查地址是否正确！"},r=function(){return 0!==t("#Validform_msg").length?!1:(e=t('<div id="Validform_msg"><div class="Validform_title">提示信息</div><div class="Validform_info"></div><a class="Validform_close" href="javascript:void(0);">确定</a><div class="iframe"><iframe frameborder="0" scrolling="no" height="100%" width="100%"></iframe></div></div>').appendTo("body"),e.find("a.Validform_close").click(function(){return e.hide(),a=!0,i&&i.focus().addClass("Validform_error"),!1}).focus(function(){this.blur()}),void t(window).bind("scroll resize",function(){if(!a){var i=(t(window).width()-e.width())/2,s=(t(window).height()-e.height())/2,r=(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop)+(s>0?s:0);e.animate({left:i,top:r},{duration:400,queue:!1})}}))};t.fn.Validform=function(e){e=t.extend({},t.fn.Validform.sn.defaults,e),e.datatype&&t.extend(t.Datatype,e.datatype),this.each(function(){var r=t(this),o=!1;r.find("[tip]").each(function(){var e=t(this).attr("tip"),i=t(this).attr("altercss");t(this).focus(function(){t(this).val()==e&&(t(this).val(""),i&&t(this).removeClass(i))}).blur(function(){""===t.trim(t(this).val())&&(t(this).val(e),i&&t(this).addClass(i))})}),r.find("[datatype]").blur(function(){var a=!0;if(a=t.fn.Validform.sn.checkform(t(this),r,{type:e.tiptype,sweep:e.tipSweep},"hide"),!a)return!1;if("boolean"!=typeof a)return t(this).removeClass("Validform_error"),!1;if(a=t.fn.Validform.sn.regcheck(t(this).attr("datatype"),t(this).val()))if(t(this).attr("ajaxurl")){var o=t(this);o.attr("valid",s.c),t.fn.Validform.sn.showmsg(s.c,e.tiptype,{obj:o,type:1,sweep:e.tipSweep},"hide"),t.ajax({type:"POST",url:o.attr("ajaxurl"),data:"param="+t(this).val()+"&name="+t(this).attr("name"),dataType:"text",success:function(a){"y"==a?(o.attr("valid","true"),i=null,t.fn.Validform.sn.showmsg(s.r,e.tiptype,{obj:o,type:2,sweep:e.tipSweep},"hide")):(o.attr("valid",a),i=o,t.fn.Validform.sn.showmsg(a,e.tiptype,{obj:o,sweep:e.tipSweep}))},error:function(){o.attr("valid",s.err),i=o,t.fn.Validform.sn.showmsg(s.err,e.tiptype,{obj:o,sweep:e.tipSweep})}})}else i=null,t.fn.Validform.sn.showmsg(s.r,e.tiptype,{obj:t(this),type:2,sweep:e.tipSweep},"hide");else{if("ignore"===t(this).attr("ignore")&&(""===t(this).val()||t(this).val()===t(this).attr("tip")))return 2==e.tiptype?t(this).parent().next().find(".Validform_checktip").removeClass().addClass("Validform_checktip").text(""):"function"==typeof e.tiptype&&e.tiptype("",{obj:t(this),type:4},t.fn.Validform.sn.cssctl),a=!0,i=null,!0;i=t(this),t.fn.Validform.sn.showmsg(t(this).attr("errormsg")||s.w,e.tiptype,{obj:t(this),sweep:e.tipSweep},"hide")}}),r.find(":checkbox[datatype],:radio[datatype]").each(function(){var e=t(this),i=e.attr("name");r.find("[name="+i+"]").filter(":checkbox,:radio").not("[datatype]").bind("blur",function(){e.trigger("blur")})});var n=function(){var n=!0;if(o)return!1;if(r.find("[datatype]").each(function(){if(n=t.fn.Validform.sn.checkform(t(this),r,{type:e.tiptype,sweep:e.tipSweep}),!n)return i.focus(),!1;if("boolean"!=typeof n)return n=!0,!0;if(n=t.fn.Validform.sn.regcheck(t(this).attr("datatype"),t(this).val()),!n)return"ignore"!==t(this).attr("ignore")||""!==t(this).val()&&t(this).val()!==t(this).attr("tip")?(i=t(this),i.focus(),t.fn.Validform.sn.showmsg(t(this).attr("errormsg")||s.w,e.tiptype,{obj:t(this),sweep:e.tipSweep}),!1):(n=!0,i=null,!0);if(t(this).attr("ajaxurl")){if("true"!=t(this).attr("valid")){n=!1;var o=t(this);return i=o,i.focus(),t.fn.Validform.sn.showmsg(o.attr("valid")||s.v,e.tiptype,{obj:o,sweep:e.tipSweep}),a&&1==e.tiptype||setTimeout(function(){o.trigger("blur")},2e3),!1}t.fn.Validform.sn.showmsg(s.r,e.tiptype,{obj:t(this),type:2,sweep:e.tipSweep},"hide"),n=!0}}),n&&!o){if(i=null,e.postonce&&(o=!0),e.ajaxPost)return t.fn.Validform.sn.showmsg(s.p,e.tiptype,{type:1,sweep:e.tipSweep},"alwaysshow"),t.ajax({type:"POST",dataType:"json",url:r.attr("action"),data:r.serialize(),success:function(i){t.fn.Validform.sn.showmsg(i.info,e.tiptype,{type:2,sweep:e.tipSweep},"alwaysshow"),e.callback&&e.callback(i)},error:function(){t.fn.Validform.sn.showmsg(s.err,e.tiptype,{type:3,sweep:e.tipSweep},"alwaysshow")}}),!1;e.callback?e.callback():r.get(0).submit()}};e.btnSubmit&&r.find(e.btnSubmit).bind("click",n),r.submit(function(){return n(),!1})}),(1==e.tiptype||2==e.tiptype&&e.ajaxPost)&&r()},t.fn.Validform.sn={defaults:{tiptype:1,tipSweep:!1,postonce:!1,ajaxPost:!1},toString:Object.prototype.toString,regcheck:function(e,i){if(!(e in t.Datatype)){var a,s=e.match(t.Datatype.match);t:for(var r in t.Datatype)if(a=r.match(t.Datatype.match),a&&s[1]===a[1]){var o=t.Datatype[r].toString(),n=new RegExp("\\{"+a[2]+","+a[3]+"\\}");o=o.replace(n,"{"+s[2]+","+s[3]+"}").replace(/^\//,"").replace(/\/$/,""),t.Datatype[e]=new RegExp(o);break t}}return"[object RegExp]"==this.toString.call(t.Datatype[e])?t.Datatype[e].test(i):!1},showmsg:function(s,r,o,n){if(i&&i.addClass("Validform_error"),"function"==typeof r)return o.sweep&&"hide"==n||r(s,o,this.cssctl),!1;if((1==r||"alwaysshow"==n)&&e.find(".Validform_info").text(s),1==r&&"hide"!=n||"alwaysshow"==n){a=!1,e.find(".iframe").css("height",e.height());var p=(t(window).width()-e.width())/2,l=(t(window).height()-e.height())/2;l=(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop)+(l>0?l:0),e.css({left:p}).show().animate({top:l},100)}2==r&&(o.obj.parent().next().find(".Validform_checktip").text(s),this.cssctl(o.obj.parent().next().find(".Validform_checktip"),o.type))},checkform:function(t,e,a,r){var o,n=t.attr("errormsg")||s.w;if(t.is("[datatype='radio']")){o=t.attr("name");var p=e.find(":radio[name="+o+"]:checked").val();return p?(i=null,this.showmsg(s.r,a.type,{obj:t,type:2,sweep:a.sweep},"hide"),"radio"):(i=t,this.showmsg(n,a.type,{obj:t,sweep:a.sweep},r),!1)}if(t.is("[datatype='checkbox']")){o=t.attr("name");var l=e.find(":checkbox[name="+o+"]:checked").val();return l?(i=null,this.showmsg(s.r,a.type,{obj:t,type:2,sweep:a.sweep},"hide"),"checkbox"):(i=t,this.showmsg(n,a.type,{obj:t,sweep:a.sweep},r),!1)}if(t.is("[datatype='select']"))return t.val()?(i=null,this.showmsg(s.r,a.type,{obj:t,type:2,sweep:a.sweep},"hide"),"select"):(i=t,this.showmsg(n,a.type,{obj:t,sweep:a.sweep},r),!1);var d=t.attr("tip");if((""===t.val()||t.val()===d)&&"ignore"!=t.attr("ignore"))return i=t,this.showmsg(t.attr("nullmsg")||s.s,a.type,{obj:t,sweep:a.sweep},r),!1;if(t.attr("recheck")){var f=e.find("input[name="+t.attr("recheck")+"]:first");if(t.val()!=f.val())return i=t,this.showmsg(n,a.type,{obj:t,sweep:a.sweep},r),!1}return t.removeClass("Validform_error"),i=null,!0},cssctl:function(t,e){switch(e){case 1:t.removeClass("Validform_right Validform_wrong").addClass("Validform_checktip Validform_loading");break;case 2:t.removeClass("Validform_wrong Validform_loading").addClass("Validform_checktip Validform_right");break;case 4:t.removeClass("Validform_right Validform_wrong Validform_loading").addClass("Validform_checktip");break;default:t.removeClass("Validform_right Validform_loading").addClass("Validform_checktip Validform_wrong")}}},t.Showmsg=function(e){r(),t.fn.Validform.sn.showmsg(e,1)},t.Hidemsg=function(){e.hide(),a=!0},t.Datatype={match:/^(.+)(\d+)-(\d+)$/,"*":/^[^\s]+$/,"*6-16":/^[^\s]{6,16}$/,n:/^\d+$/,s:/^[\u4E00-\u9FA5\uf900-\ufa2d\w]+$/,"s6-18":/^[\u4E00-\u9FA5\uf900-\ufa2d\w]{6,18}$/,p:/^[0-9]{6}$/,m:/^13[0-9]{9}$|15[0-9]{9}$|18[0-9]{9}$/,e:/^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,uId:/^(\d{15}|\d{17}[\dX])$/}}(jQuery);